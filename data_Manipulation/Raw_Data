import yfinance as yf
import pandas as pd
from datetime import datetime
import os

# 1️⃣ Ensure Raw_Data folder exists
os.makedirs("Raw_Data", exist_ok=True)

# 2️⃣ Download historical gold data (GLD ETF)
gold = yf.Ticker("GLD")

# Period: 2015-01-01 to today
start_date = "2015-01-01"
end_date = datetime.today().strftime('%Y-%m-%d')
data = gold.history(start=start_date, end=end_date)

# 3️⃣ Check if data was downloaded
if data.empty:
    print("No data downloaded! Check your internet connection or the ticker symbol.")
else:
    # 4️⃣ Display a preview of the data
    print("Preview of the data:")
    print(data.head())  # first 5 rows
    print(f"Total rows downloaded: {len(data)}")

    # 5️⃣ Save CSV in Raw_Data folder
    csv_path = f"Raw_Data/gold_prices_2015_{end_date}.csv"
    data.to_csv(csv_path)
    print(f"CSV created at: {os.path.abspath(csv_path)}")




